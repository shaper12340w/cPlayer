\doxysection{file\+Manager.\+cpp íŒŒì¼ ì°¸ì¡°}
\hypertarget{file_manager_8cpp}{}\label{file_manager_8cpp}\index{fileManager.cpp@{fileManager.cpp}}
{\ttfamily \#include $<$windows.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$shlobj.\+h$>$}\newline
{\ttfamily \#include $<$shobjidl.\+h$>$}\newline
{\ttfamily \#include $<$tchar.\+h$>$}\newline
{\ttfamily \#include "{}player\+UI.\+h"{}}\newline
{\ttfamily \#include "{}music\+Player.\+h"{}}\newline
{\ttfamily \#include "{}dynamic\+Array.\+h"{}}\newline
file\+Manager.\+cppì— ëŒ€í•œ include ì˜ì¡´ ê·¸ë˜í”„
% FIG 0
\doxysubsubsection*{ë§¤í¬ë¡œ}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{file_manager_8cpp_af08ec37a8c99d747fb60fa15bc28678b}{\+\_\+\+CRT\+\_\+\+SECURE\+\_\+\+NO\+\_\+\+WARNINGS}}
\end{DoxyCompactItemize}
\doxysubsubsection*{í•¨ìˆ˜}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{file_manager_8cpp_ab5e94040b110d1f6ce242bc146dd907a}{Delete\+Temp\+File}} ()
\item 
int \mbox{\hyperlink{file_manager_8cpp_ae5a0c844e53d1566adcca2543819fa4a}{Set\+File\+Hidden}} (const wchar\+\_\+t \texorpdfstring{$\ast$}{*}path)
\item 
int \mbox{\hyperlink{file_manager_8cpp_ad55f46581d81a52cb1dda780833bf687}{Remove\+Tag}} (const wchar\+\_\+t \texorpdfstring{$\ast$}{*}origin\+Path, wchar\+\_\+t \texorpdfstring{$\ast$}{*}temp\+Path\+Out, size\+\_\+t string\+Size)
\item 
void \mbox{\hyperlink{file_manager_8cpp_a228af4c49d625b5dcbe3dd03090b9866}{Save\+Temporary\+MP3}} (const wchar\+\_\+t \texorpdfstring{$\ast$}{*}path, wchar\+\_\+t \texorpdfstring{$\ast$}{*}temp\+Path\+Out, size\+\_\+t string\+Size)
\item 
void \mbox{\hyperlink{file_manager_8cpp_a4b4003b077c4aabae8264807edb8a907}{Open\+File\+Dialog}} (wchar\+\_\+t \texorpdfstring{$\ast$}{*}file\+Path)
\item 
void \mbox{\hyperlink{file_manager_8cpp_add81119dd68a2f115829137d894715f5}{Open\+Folder\+Dialog}} (wchar\+\_\+t \texorpdfstring{$\ast$}{*}path)
\item 
void \mbox{\hyperlink{file_manager_8cpp_a3f6837e8ccc42ee1dfd56f6908724833}{List\+MP3\+Files\+In\+Folder}} (const wchar\+\_\+t \texorpdfstring{$\ast$}{*}folder\+Path, \mbox{\hyperlink{struct_string_array}{String\+Array}} \texorpdfstring{$\ast$}{*}array)
\end{DoxyCompactItemize}
\doxysubsubsection*{ë³€ìˆ˜}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{file_manager_8cpp_a33b6590673b617e81895a4098631cccc}{stack}} = 0
\end{DoxyCompactItemize}


\doxysubsection{ë§¤í¬ë¡œ ë¬¸ì„œí™”}
\Hypertarget{file_manager_8cpp_af08ec37a8c99d747fb60fa15bc28678b}\index{fileManager.cpp@{fileManager.cpp}!\_CRT\_SECURE\_NO\_WARNINGS@{\_CRT\_SECURE\_NO\_WARNINGS}}
\index{\_CRT\_SECURE\_NO\_WARNINGS@{\_CRT\_SECURE\_NO\_WARNINGS}!fileManager.cpp@{fileManager.cpp}}
\doxysubsubsection{\texorpdfstring{\_CRT\_SECURE\_NO\_WARNINGS}{\_CRT\_SECURE\_NO\_WARNINGS}}
{\footnotesize\ttfamily \label{file_manager_8cpp_af08ec37a8c99d747fb60fa15bc28678b} 
\#define \+\_\+\+CRT\+\_\+\+SECURE\+\_\+\+NO\+\_\+\+WARNINGS}



\mbox{\hyperlink{file_manager_8cpp_source}{file\+Manager.\+cpp}} íŒŒì¼ì˜ \mbox{\hyperlink{file_manager_8cpp_source_l00001}{1}} ë²ˆì§¸ ë¼ì¸ì—ì„œ ì •ì˜ë˜ì—ˆìŠµë‹ˆë‹¤.



\doxysubsection{í•¨ìˆ˜ ë¬¸ì„œí™”}
\Hypertarget{file_manager_8cpp_ab5e94040b110d1f6ce242bc146dd907a}\index{fileManager.cpp@{fileManager.cpp}!DeleteTempFile@{DeleteTempFile}}
\index{DeleteTempFile@{DeleteTempFile}!fileManager.cpp@{fileManager.cpp}}
\doxysubsubsection{\texorpdfstring{DeleteTempFile()}{DeleteTempFile()}}
{\footnotesize\ttfamily \label{file_manager_8cpp_ab5e94040b110d1f6ce242bc146dd907a} 
void Delete\+Temp\+File (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



\mbox{\hyperlink{file_manager_8cpp_source}{file\+Manager.\+cpp}} íŒŒì¼ì˜ \mbox{\hyperlink{file_manager_8cpp_source_l00015}{15}} ë²ˆì§¸ ë¼ì¸ì—ì„œ ì •ì˜ë˜ì—ˆìŠµë‹ˆë‹¤.


\begin{DoxyCode}{0}
\DoxyCodeLine{00015\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00016\ \ \ \ \ \textcolor{keywordtype}{char}\ temp[260];}
\DoxyCodeLine{00017\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{dynamic_array_8cpp_a72f77dc17158db19cf48394ee69d34e7}{getIntArrayLength}}(\&\mbox{\hyperlink{music_player_8cpp_a6a21669261f0832b477f6c237eebe18b}{player}}.\mbox{\hyperlink{struct_player_data_a81cfd0c02949410fff2beddecaebd7b2}{deletedArray}});\ i++)\ \{}
\DoxyCodeLine{00018\ \ \ \ \ \ \ \ \ wcstombs(temp,\ \mbox{\hyperlink{dynamic_array_8cpp_a5921838065e1c0e27a510ea32a5941db}{getStringArrayValue}}(\&\mbox{\hyperlink{music_player_8cpp_a6a21669261f0832b477f6c237eebe18b}{player}}.\mbox{\hyperlink{struct_player_data_a4a076522905a02d538180355f5514970}{pathArray}},\ \mbox{\hyperlink{dynamic_array_8cpp_af1342933a39b755287cd8a7d017ce715}{getIntArrayValue}}(\&\mbox{\hyperlink{music_player_8cpp_a6a21669261f0832b477f6c237eebe18b}{player}}.\mbox{\hyperlink{struct_player_data_a81cfd0c02949410fff2beddecaebd7b2}{deletedArray}},\ i)),\ \textcolor{keyword}{sizeof}(temp));}
\DoxyCodeLine{00019\ \ \ \ \ \ \ \ \ remove(temp);}
\DoxyCodeLine{00020\ \ \ \ \ \}}
\DoxyCodeLine{00021\ \}}

\end{DoxyCode}
ì´ í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ë“¤ì— ëŒ€í•œ ê·¸ë˜í”„ì…ë‹ˆë‹¤.\+:
% FIG 1
ì´ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ë“¤ì— ëŒ€í•œ ê·¸ë˜í”„ì…ë‹ˆë‹¤.\+:
% FIG 2
\Hypertarget{file_manager_8cpp_a3f6837e8ccc42ee1dfd56f6908724833}\index{fileManager.cpp@{fileManager.cpp}!ListMP3FilesInFolder@{ListMP3FilesInFolder}}
\index{ListMP3FilesInFolder@{ListMP3FilesInFolder}!fileManager.cpp@{fileManager.cpp}}
\doxysubsubsection{\texorpdfstring{ListMP3FilesInFolder()}{ListMP3FilesInFolder()}}
{\footnotesize\ttfamily \label{file_manager_8cpp_a3f6837e8ccc42ee1dfd56f6908724833} 
void List\+MP3\+Files\+In\+Folder (\begin{DoxyParamCaption}\item[{const wchar\+\_\+t \texorpdfstring{$\ast$}{*}}]{folder\+Path}{, }\item[{\mbox{\hyperlink{struct_string_array}{String\+Array}} \texorpdfstring{$\ast$}{*}}]{array}{}\end{DoxyParamCaption})}



\mbox{\hyperlink{file_manager_8cpp_source}{file\+Manager.\+cpp}} íŒŒì¼ì˜ \mbox{\hyperlink{file_manager_8cpp_source_l00175}{175}} ë²ˆì§¸ ë¼ì¸ì—ì„œ ì •ì˜ë˜ì—ˆìŠµë‹ˆë‹¤.


\begin{DoxyCode}{0}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00176\ \ \ \ \ WIN32\_FIND\_DATAW\ findData;}
\DoxyCodeLine{00177\ \ \ \ \ HANDLE\ hFind\ =\ INVALID\_HANDLE\_VALUE;}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{keywordtype}{wchar\_t}\ searchPath[MAX\_PATH];}
\DoxyCodeLine{00180\ \ \ \ \ swprintf(searchPath,\ MAX\_PATH,\ L\textcolor{stringliteral}{"{}\%s\(\backslash\)\(\backslash\)*"{}},\ folderPath);\ \textcolor{comment}{//\ ¸ğµç ÆÄÀÏ}}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \ \ \ \ \textcolor{comment}{//\ Ã¹\ ¹øÂ° ÆÄÀÏ Ã£±â}}
\DoxyCodeLine{00183\ \ \ \ \ hFind\ =\ FindFirstFileW(searchPath,\ \&findData);}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00185\ \ \ \ \ \textcolor{keywordflow}{if}\ (hFind\ ==\ INVALID\_HANDLE\_VALUE)\ \{}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ wprintf(L\textcolor{stringliteral}{"{}No\ files\ or\ folders\ found\ in\ folder:\ \%s\(\backslash\)n"{}},\ folderPath);}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00188\ \ \ \ \ \}}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ \ \ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (wcscmp(findData.cFileName,\ L\textcolor{stringliteral}{"{}."{}})\ ==\ 0\ ||\ wcscmp(findData.cFileName,\ L\textcolor{stringliteral}{"{}.."{}})\ ==\ 0)}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{wchar\_t}\ filePath[MAX\_PATH];}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ swprintf(filePath,\ MAX\_PATH,\ L\textcolor{stringliteral}{"{}\%s\(\backslash\)\(\backslash\)\%s"{}},\ folderPath,\ findData.cFileName);}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (findData.dwFileAttributes\ \&\ FILE\_ATTRIBUTE\_DIRECTORY)}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{file_manager_8cpp_a3f6837e8ccc42ee1dfd56f6908724833}{ListMP3FilesInFolder}}(filePath,\ array);}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{wchar\_t}*\ extension\ =\ wcschr(findData.cFileName,\ L\textcolor{charliteral}{'.'});}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (extension\ \&\&\ \_wcsicmp(extension,\ L\textcolor{stringliteral}{"{}.mp3"{}})\ ==\ 0)\ }
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{dynamic_array_8cpp_aeeb7693e1628d77d5d8426f38a4775fa}{addStringArrayValue}}(array,\ filePath);}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00208\ \ \ \ \ \}\ \textcolor{keywordflow}{while}\ (FindNextFileW(hFind,\ \&findData)\ !=\ 0);}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \ \ \ \ \textcolor{comment}{//\ ÇÚµé ´İ±â}}
\DoxyCodeLine{00211\ \ \ \ \ FindClose(hFind);}
\DoxyCodeLine{00212\ \}}

\end{DoxyCode}
ì´ í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ë“¤ì— ëŒ€í•œ ê·¸ë˜í”„ì…ë‹ˆë‹¤.\+:
% FIG 3
ì´ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ë“¤ì— ëŒ€í•œ ê·¸ë˜í”„ì…ë‹ˆë‹¤.\+:
% FIG 4
\Hypertarget{file_manager_8cpp_a4b4003b077c4aabae8264807edb8a907}\index{fileManager.cpp@{fileManager.cpp}!OpenFileDialog@{OpenFileDialog}}
\index{OpenFileDialog@{OpenFileDialog}!fileManager.cpp@{fileManager.cpp}}
\doxysubsubsection{\texorpdfstring{OpenFileDialog()}{OpenFileDialog()}}
{\footnotesize\ttfamily \label{file_manager_8cpp_a4b4003b077c4aabae8264807edb8a907} 
void Open\+File\+Dialog (\begin{DoxyParamCaption}\item[{wchar\+\_\+t \texorpdfstring{$\ast$}{*}}]{file\+Path}{}\end{DoxyParamCaption})}



\mbox{\hyperlink{file_manager_8cpp_source}{file\+Manager.\+cpp}} íŒŒì¼ì˜ \mbox{\hyperlink{file_manager_8cpp_source_l00102}{102}} ë²ˆì§¸ ë¼ì¸ì—ì„œ ì •ì˜ë˜ì—ˆìŠµë‹ˆë‹¤.


\begin{DoxyCode}{0}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \ \ OPENFILENAMEW\ ofn;}
\DoxyCodeLine{00105\ \ \ \ \ ZeroMemory(\&ofn,\ \textcolor{keyword}{sizeof}(ofn));}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \ \ \ \ ofn.hwndOwner\ =\ NULL;\ }
\DoxyCodeLine{00108\ \ \ \ \ ofn.lStructSize\ =\ \textcolor{keyword}{sizeof}(ofn);}
\DoxyCodeLine{00109\ \ \ \ \ ofn.lpstrFile\ =\ filePath;}
\DoxyCodeLine{00110\ \ \ \ \ ofn.nMaxFile\ =\ MAX\_PATH;}
\DoxyCodeLine{00111\ \ \ \ \ ofn.lpstrFilter\ =\ L\textcolor{stringliteral}{"{}MP3\ Files\(\backslash\)0*.mp3\(\backslash\)0"{}};}
\DoxyCodeLine{00112\ \ \ \ \ ofn.nFileOffset\ =\ 1;}
\DoxyCodeLine{00113\ \ \ \ \ ofn.Flags\ =\ OFN\_PATHMUSTEXIST\ |\ OFN\_FILEMUSTEXIST;}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keywordflow}{if}\ (!GetOpenFileNameW(\&ofn))\ \{}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{player_u_i_8cpp_a409471bd6e26238b55939ea334bf2478}{clearLine}}(6);\ \mbox{\hyperlink{player_u_i_8cpp_a9d1008cd1f195593b51aa49bd912dac1}{uprintf}}(6,\ L\textcolor{stringliteral}{"{}Canceled\(\backslash\)n"{}});}
\DoxyCodeLine{00117\ \ \ \ \ \}}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00119\ \}}

\end{DoxyCode}
ì´ í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ë“¤ì— ëŒ€í•œ ê·¸ë˜í”„ì…ë‹ˆë‹¤.\+:
% FIG 5
ì´ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ë“¤ì— ëŒ€í•œ ê·¸ë˜í”„ì…ë‹ˆë‹¤.\+:
% FIG 6
\Hypertarget{file_manager_8cpp_add81119dd68a2f115829137d894715f5}\index{fileManager.cpp@{fileManager.cpp}!OpenFolderDialog@{OpenFolderDialog}}
\index{OpenFolderDialog@{OpenFolderDialog}!fileManager.cpp@{fileManager.cpp}}
\doxysubsubsection{\texorpdfstring{OpenFolderDialog()}{OpenFolderDialog()}}
{\footnotesize\ttfamily \label{file_manager_8cpp_add81119dd68a2f115829137d894715f5} 
void Open\+Folder\+Dialog (\begin{DoxyParamCaption}\item[{wchar\+\_\+t \texorpdfstring{$\ast$}{*}}]{path}{}\end{DoxyParamCaption})}



\mbox{\hyperlink{file_manager_8cpp_source}{file\+Manager.\+cpp}} íŒŒì¼ì˜ \mbox{\hyperlink{file_manager_8cpp_source_l00121}{121}} ë²ˆì§¸ ë¼ì¸ì—ì„œ ì •ì˜ë˜ì—ˆìŠµë‹ˆë‹¤.


\begin{DoxyCode}{0}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{comment}{//\ COM\ ÃÊ±âÈ­}}
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{keywordflow}{if}\ (FAILED(CoInitialize(NULL)))\ \{}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Failed\ to\ initialize\ COM\ library.\(\backslash\)n"{}});}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00126\ \ \ \ \ \}}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00128\ \ \ \ \ IFileDialog*\ pFileDialog\ =\ NULL;}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{comment}{//\ IFileDialog\ ÀÎ½ºÅÏ½º\ »ı¼º}}
\DoxyCodeLine{00131\ \ \ \ \ HRESULT\ hr\ =\ CoCreateInstance(CLSID\_FileOpenDialog,\ NULL,\ CLSCTX\_INPROC\_SERVER,\ IID\_IFileDialog,\ (\textcolor{keywordtype}{void}**)\&pFileDialog);}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keywordflow}{if}\ (SUCCEEDED(hr))\ \{}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ¿É¼Ç ¼³Á¤:\ Æú´õ ¼±ÅÃ\ È°¼ºÈ­}}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ DWORD\ options\ =\ 0;}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ pFileDialog-\/>GetOptions(\&options);}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ pFileDialog-\/>SetOptions(options\ |\ FOS\_PICKFOLDERS);}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ´ëÈ­\ »óÀÚ Ç¥½Ã}}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ hr\ =\ pFileDialog-\/>Show(NULL);}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (SUCCEEDED(hr))\ \{}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ IShellItem*\ pItem\ =\ NULL;}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ¼±ÅÃµÈ ¾ÆÀÌÅÛ °¡Á®¿À±â}}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ hr\ =\ pFileDialog-\/>GetResult(\&pItem);}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (SUCCEEDED(hr))\ \{}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PWSTR\ folderPath\ =\ NULL;}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{wchar\_t}\ returnPath[MAX\_PATH];}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ¼±ÅÃµÈ Æú´õ °æ·Î °¡Á®¿À±â}}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hr\ =\ pItem-\/>GetDisplayName(SIGDN\_FILESYSPATH,\ \&folderPath);}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (SUCCEEDED(hr))\ \{}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ wcscpy\_s(path,\ MAX\_PATH,\ folderPath);}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ wprintf(L\textcolor{stringliteral}{"{}Selected\ Folder:\ \%s\(\backslash\)n"{}},\ folderPath);}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CoTaskMemFree(folderPath);\ \textcolor{comment}{//\ °æ·Î\ ¸Ş¸ğ¸® ÇØÁ¦}}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pItem-\/>Release();\ \textcolor{comment}{//\ IShellItem\ ÇØÁ¦}}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Folder\ selection\ canceled\ or\ failed.\(\backslash\)n"{}});}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ pFileDialog-\/>Release();\ \textcolor{comment}{//\ IFileDialog\ ÇØÁ¦}}
\DoxyCodeLine{00166\ \ \ \ \ \}}
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Failed\ to\ create\ IFileDialog\ instance.\(\backslash\)n"{}});}
\DoxyCodeLine{00169\ \ \ \ \ \}}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{comment}{//\ COM\ ÇØÁ¦}}
\DoxyCodeLine{00172\ \ \ \ \ CoUninitialize();}
\DoxyCodeLine{00173\ \}}

\end{DoxyCode}
ì´ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ë“¤ì— ëŒ€í•œ ê·¸ë˜í”„ì…ë‹ˆë‹¤.\+:
% FIG 7
\Hypertarget{file_manager_8cpp_ad55f46581d81a52cb1dda780833bf687}\index{fileManager.cpp@{fileManager.cpp}!RemoveTag@{RemoveTag}}
\index{RemoveTag@{RemoveTag}!fileManager.cpp@{fileManager.cpp}}
\doxysubsubsection{\texorpdfstring{RemoveTag()}{RemoveTag()}}
{\footnotesize\ttfamily \label{file_manager_8cpp_ad55f46581d81a52cb1dda780833bf687} 
int Remove\+Tag (\begin{DoxyParamCaption}\item[{const wchar\+\_\+t \texorpdfstring{$\ast$}{*}}]{origin\+Path}{, }\item[{wchar\+\_\+t \texorpdfstring{$\ast$}{*}}]{temp\+Path\+Out}{, }\item[{size\+\_\+t}]{string\+Size}{}\end{DoxyParamCaption})}



\mbox{\hyperlink{file_manager_8cpp_source}{file\+Manager.\+cpp}} íŒŒì¼ì˜ \mbox{\hyperlink{file_manager_8cpp_source_l00031}{31}} ë²ˆì§¸ ë¼ì¸ì—ì„œ ì •ì˜ë˜ì—ˆìŠµë‹ˆë‹¤.


\begin{DoxyCode}{0}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{keywordtype}{wchar\_t}\ tempPath[MAX\_PATH]\ =\ L\textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{keywordtype}{wchar\_t}\ appPath[MAX\_PATH];}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{wchar\_t}*\ fileName\ =\ wcsrchr(originPath,\ L\textcolor{charliteral}{'\(\backslash\)\(\backslash\)'});}
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keywordflow}{if}\ (!fileName)\ \{}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Invalid\ file\ path\(\backslash\)n"{}});}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00038\ \ \ \ \ \}}
\DoxyCodeLine{00039\ \ \ \ \ GetModuleFileNameW(NULL,\ appPath,\ MAX\_PATH);}
\DoxyCodeLine{00040\ \ \ \ \ *wcsrchr(appPath,\ L\textcolor{charliteral}{'\(\backslash\)\(\backslash\)'})\ =\ L\textcolor{charliteral}{'\(\backslash\)0'};\ \textcolor{comment}{//\ °æ·Î¿¡¼­\ ¸¶Áö¸·\ '\(\backslash\)\(\backslash\)'\ µÚ¸¦\ Àß¶ó³»±â}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ wcscat(tempPath,\ appPath);}
\DoxyCodeLine{00043\ \ \ \ \ wcscat(tempPath,\ fileName);}
\DoxyCodeLine{00044\ \ \ \ \ wcscpy\_s(tempPathOut,\ stringSize,\ tempPath);}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ \ \ FILE*\ inputFile\ =\ \_wfopen(originPath,\ L\textcolor{stringliteral}{"{}rb"{}});}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keywordflow}{if}\ (!inputFile)\ \{}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Cannot\ open\ file:\ \%ls\(\backslash\)n"{}},\ originPath);}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00051\ \ \ \ \ \}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ header[10];}
\DoxyCodeLine{00054\ \ \ \ \ fread(header,\ 1,\ 10,\ inputFile);}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{comment}{//\ ID3v2\ ÅÂ±× È®ÀÎ}}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keywordflow}{if}\ (strncmp((\textcolor{keywordtype}{char}*)header,\ \textcolor{stringliteral}{"{}ID3"{}},\ 3)\ ==\ 0)\ \{}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ tagSize\ =\ (header[6]\ <<\ 21)\ |\ (header[7]\ <<\ 14)\ |\ (header[8]\ <<\ 7)\ |\ header[9];}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ FILE*\ outputFile\ =\ \_wfopen(tempPath,\ L\textcolor{stringliteral}{"{}wb"{}});}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!outputFile)\ \{}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Cannot\ create\ output\ file:\ \%ls\(\backslash\)n"{}},\ tempPath);}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{file_manager_8cpp_a33b6590673b617e81895a4098631cccc}{stack}}\ <\ 5)\ \{}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{file_manager_8cpp_ab5e94040b110d1f6ce242bc146dd907a}{DeleteTempFile}}();}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{file_manager_8cpp_ad55f46581d81a52cb1dda780833bf687}{RemoveTag}}(originPath,\ tempPathOut,\ stringSize);}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fclose(inputFile);}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{file_manager_8cpp_a33b6590673b617e81895a4098631cccc}{stack}}++;}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fclose(inputFile);}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ fseek(inputFile,\ 10\ +\ tagSize,\ SEEK\_SET);\ \textcolor{comment}{//\ ÆÄÀÏ\ Æ÷ÀÎÅÍ¸¦\ ÅÂ±× ÀÌÈÄ·Î ÀÌµ¿}}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ buffer[1024];}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ bytesRead;}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ ((bytesRead\ =\ fread(buffer,\ 1,\ \textcolor{keyword}{sizeof}(buffer),\ inputFile))\ >\ 0)\ \{}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \ \ fwrite(buffer,\ 1,\ bytesRead,\ outputFile);}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ fclose(inputFile);}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ fclose(outputFile);}
\DoxyCodeLine{00084\ \ \ \ \ \}}
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}No\ ID3\ tag\ found\ in\ the\ file\(\backslash\)n"{}});}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ fclose(inputFile);}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00089\ \ \ \ \ \}}
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00091\ \}}

\end{DoxyCode}
ì´ í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ë“¤ì— ëŒ€í•œ ê·¸ë˜í”„ì…ë‹ˆë‹¤.\+:
% FIG 8
ì´ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ë“¤ì— ëŒ€í•œ ê·¸ë˜í”„ì…ë‹ˆë‹¤.\+:
% FIG 9
\Hypertarget{file_manager_8cpp_a228af4c49d625b5dcbe3dd03090b9866}\index{fileManager.cpp@{fileManager.cpp}!SaveTemporaryMP3@{SaveTemporaryMP3}}
\index{SaveTemporaryMP3@{SaveTemporaryMP3}!fileManager.cpp@{fileManager.cpp}}
\doxysubsubsection{\texorpdfstring{SaveTemporaryMP3()}{SaveTemporaryMP3()}}
{\footnotesize\ttfamily \label{file_manager_8cpp_a228af4c49d625b5dcbe3dd03090b9866} 
void Save\+Temporary\+MP3 (\begin{DoxyParamCaption}\item[{const wchar\+\_\+t \texorpdfstring{$\ast$}{*}}]{path}{, }\item[{wchar\+\_\+t \texorpdfstring{$\ast$}{*}}]{temp\+Path\+Out}{, }\item[{size\+\_\+t}]{string\+Size}{}\end{DoxyParamCaption})}



\mbox{\hyperlink{file_manager_8cpp_source}{file\+Manager.\+cpp}} íŒŒì¼ì˜ \mbox{\hyperlink{file_manager_8cpp_source_l00096}{96}} ë²ˆì§¸ ë¼ì¸ì—ì„œ ì •ì˜ë˜ì—ˆìŠµë‹ˆë‹¤.


\begin{DoxyCode}{0}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00097\ \ \ \ \ }
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{file_manager_8cpp_ad55f46581d81a52cb1dda780833bf687}{RemoveTag}}(path,\ tempPathOut,\ stringSize)\ !=\ 0)\ exit(1);}
\DoxyCodeLine{00099\ \ \ \ \ \mbox{\hyperlink{file_manager_8cpp_ae5a0c844e53d1566adcca2543819fa4a}{SetFileHidden}}(tempPathOut);}
\DoxyCodeLine{00100\ \}}

\end{DoxyCode}
ì´ í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ë“¤ì— ëŒ€í•œ ê·¸ë˜í”„ì…ë‹ˆë‹¤.\+:
% FIG 10
ì´ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ë“¤ì— ëŒ€í•œ ê·¸ë˜í”„ì…ë‹ˆë‹¤.\+:
% FIG 11
\Hypertarget{file_manager_8cpp_ae5a0c844e53d1566adcca2543819fa4a}\index{fileManager.cpp@{fileManager.cpp}!SetFileHidden@{SetFileHidden}}
\index{SetFileHidden@{SetFileHidden}!fileManager.cpp@{fileManager.cpp}}
\doxysubsubsection{\texorpdfstring{SetFileHidden()}{SetFileHidden()}}
{\footnotesize\ttfamily \label{file_manager_8cpp_ae5a0c844e53d1566adcca2543819fa4a} 
int Set\+File\+Hidden (\begin{DoxyParamCaption}\item[{const wchar\+\_\+t \texorpdfstring{$\ast$}{*}}]{path}{}\end{DoxyParamCaption})}



\mbox{\hyperlink{file_manager_8cpp_source}{file\+Manager.\+cpp}} íŒŒì¼ì˜ \mbox{\hyperlink{file_manager_8cpp_source_l00023}{23}} ë²ˆì§¸ ë¼ì¸ì—ì„œ ì •ì˜ë˜ì—ˆìŠµë‹ˆë‹¤.


\begin{DoxyCode}{0}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{keywordflow}{if}\ (!SetFileAttributesW(path,\ FILE\_ATTRIBUTE\_HIDDEN))\ \{}
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Cannot\ set\ file\ hidden\(\backslash\)n"{}});}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00027\ \ \ \ \ \}}
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00029\ \}}

\end{DoxyCode}
ì´ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ë“¤ì— ëŒ€í•œ ê·¸ë˜í”„ì…ë‹ˆë‹¤.\+:
% FIG 12


\doxysubsection{ë³€ìˆ˜ ë¬¸ì„œí™”}
\Hypertarget{file_manager_8cpp_a33b6590673b617e81895a4098631cccc}\index{fileManager.cpp@{fileManager.cpp}!stack@{stack}}
\index{stack@{stack}!fileManager.cpp@{fileManager.cpp}}
\doxysubsubsection{\texorpdfstring{stack}{stack}}
{\footnotesize\ttfamily \label{file_manager_8cpp_a33b6590673b617e81895a4098631cccc} 
int stack = 0}



\mbox{\hyperlink{file_manager_8cpp_source}{file\+Manager.\+cpp}} íŒŒì¼ì˜ \mbox{\hyperlink{file_manager_8cpp_source_l00013}{13}} ë²ˆì§¸ ë¼ì¸ì—ì„œ ì •ì˜ë˜ì—ˆìŠµë‹ˆë‹¤.

