\doxysection{manage\+Console.\+cpp}
\hypertarget{manage_console_8cpp_source}{}\label{manage_console_8cpp_source}\mbox{\hyperlink{manage_console_8cpp}{Ïù¥ ÌååÏùºÏùò Î¨∏ÏÑúÌôî ÌéòÏù¥ÏßÄÎ°ú Í∞ÄÍ∏∞}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00001}00001\ \textcolor{preprocessor}{\#include\ <tchar.h>}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00002}00002\ \textcolor{preprocessor}{\#include\ <windows.h>}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00003}00003\ \textcolor{preprocessor}{\#include\ <psapi.h>}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00004}00004\ \textcolor{preprocessor}{\#include\ <stdio.h>}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00005}00005\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{player_u_i_8h}{playerUI.h}}"{}}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00007}\mbox{\hyperlink{manage_console_8cpp_a2a6e8d5b4a7b92c6f8e6c9b837b7d1c9}{00007}}\ BOOL\ CALLBACK\ \mbox{\hyperlink{manage_console_8cpp_a2a6e8d5b4a7b92c6f8e6c9b837b7d1c9}{EnumWindowsProc}}(HWND\ hwnd,\ LPARAM\ lParam)\ \{}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00008}00008\ \ \ \ \ DWORD\ processId;}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00009}00009\ \ \ \ \ GetWindowThreadProcessId(hwnd,\ \&processId);}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00011}00011\ \ \ \ \ HANDLE\ processHandle\ =\ OpenProcess(PROCESS\_QUERY\_INFORMATION\ |\ PROCESS\_VM\_READ,\ FALSE,\ processId);}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00012}00012\ \ \ \ \ \textcolor{keywordflow}{if}\ (processHandle)\ \{}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00013}00013\ \ \ \ \ \ \ \ \ TCHAR\ processName[MAX\_PATH]\ =\ \{\ 0\ \};}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00014}00014\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GetModuleBaseName(processHandle,\ NULL,\ processName,\ MAX\_PATH))\ \{}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00015}00015\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ «¡∑ŒººΩ∫\ ¿Ã∏ß¿Ã\ WindowsTerminal.exe¿Œ¡ˆ\ »Æ¿Œ}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00016}00016\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_tcsicmp(processName,\ \_T(\textcolor{stringliteral}{"{}WindowsTerminal.exe"{}}))\ ==\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00017}00017\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ HWND*\ targetHwnd\ =\ (HWND*)lParam;}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00018}00018\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *targetHwnd\ =\ hwnd;\ \textcolor{comment}{//\ πﬂ∞ﬂ«— «⁄µÈ¿ª\ ¿˙¿Â}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00019}00019\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CloseHandle(processHandle);}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00020}00020\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ FALSE;\ \ \ \ \ \ \ \textcolor{comment}{//\ ≈Ωªˆ ¡æ∑·}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00021}00021\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00022}00022\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00023}00023\ \ \ \ \ \ \ \ \ CloseHandle(processHandle);}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00024}00024\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00025}00025\ \ \ \ \ \textcolor{keywordflow}{return}\ TRUE;\ \textcolor{comment}{//\ ∞Ëº”\ ≈Ωªˆ}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00026}00026\ \}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00028}\mbox{\hyperlink{manage_console_8cpp_ae28154de2cff99671355effbe35dc415}{00028}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{manage_console_8cpp_ae28154de2cff99671355effbe35dc415}{CheckConsoleRegistry}}()\ \{}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00029}00029\ \ \ \ \ HKEY\ hkey;}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00030}00030\ \ \ \ \ DWORD\ dwSize;}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00031}00031\ \ \ \ \ \textcolor{keywordtype}{char}\ value[256];}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00033}00033\ \ \ \ \ \textcolor{keywordflow}{if}\ (RegOpenKeyEx(HKEY\_CURRENT\_USER,\ TEXT(\textcolor{stringliteral}{"{}CONSOLE\(\backslash\)\(\backslash\)\%\%Startup"{}}),\ 0,\ KEY\_READ,\ \&hkey)\ !=\ ERROR\_SUCCESS)\ \{}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00034}00034\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{player_u_i_8cpp_a409471bd6e26238b55939ea334bf2478}{clearLine}}(6);\ \mbox{\hyperlink{player_u_i_8cpp_a9d1008cd1f195593b51aa49bd912dac1}{uprintf}}(6,\ L\textcolor{stringliteral}{"{}∑π¡ˆΩ∫∆Æ∏Æ∏¶\ ø©¥¬ ∞˙¡§ø°º≠\ ø¿∑˘∞° πﬂª˝«ﬂΩ¿¥œ¥Ÿ"{}});}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00035}00035\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00036}00036\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00038}00038\ \ \ \ \ dwSize\ =\ \textcolor{keyword}{sizeof}(value);}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00039}00039\ }
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00040}00040\ \ \ \ \ \textcolor{keywordflow}{if}\ (RegQueryValueEx(hkey,\ TEXT(\textcolor{stringliteral}{"{}DelegationConsole"{}}),\ NULL,\ NULL,\ (LPBYTE)value,\ \&dwSize)\ ==\ ERROR\_SUCCESS)\ \{}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00041}00041\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (strcmp(value,\ \textcolor{stringliteral}{"{}\{2EACA947-\/7F5F-\/4CFA-\/BA87-\/8F7FBEEFBE69\}"{}})\ ==\ 0)\ \textcolor{comment}{//WIndows\ Terminal¿Ã\ ±‚∫ª\ ≈ÕπÃ≥Œ¿Œ∞°}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00042}00042\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;\ \textcolor{comment}{//yes}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00043}00043\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;\ \textcolor{comment}{//no}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00045}00045\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00046}00046\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00047}00047\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00048}00048\ \}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00049}00049\ }
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00050}\mbox{\hyperlink{manage_console_8cpp_aa486752d2d0070676af70f863c3475a9}{00050}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{manage_console_8cpp_aa486752d2d0070676af70f863c3475a9}{resizeWindow}}(\textcolor{keywordtype}{int}\ width,\ \textcolor{keywordtype}{int}\ height)\ \{}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00051}00051\ \ \ \ \ HWND\ targetHwnd\ =\ NULL;}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00052}00052\ \ \ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{manage_console_8cpp_ae28154de2cff99671355effbe35dc415}{CheckConsoleRegistry}}())\ \{}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00053}00053\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00054}00054\ \ \ \ \ \ \ \ \ EnumWindows(\mbox{\hyperlink{manage_console_8cpp_a2a6e8d5b4a7b92c6f8e6c9b837b7d1c9}{EnumWindowsProc}},\ (LPARAM)\&targetHwnd);}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00055}00055\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (targetHwnd\ ==\ NULL)\ \{}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00056}00056\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{player_u_i_8cpp_a409471bd6e26238b55939ea334bf2478}{clearLine}}(6);\ \mbox{\hyperlink{player_u_i_8cpp_a9d1008cd1f195593b51aa49bd912dac1}{uprintf}}(6,\ L\textcolor{stringliteral}{"{}WindowsTerminal\ √¢¿ª\ √£¿ª\ ºˆ æ¯Ω¿¥œ¥Ÿ.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00057}00057\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00058}00058\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00059}00059\ \ \ \ \ \ \ \ \ MoveWindow(targetHwnd,\ 100,\ 100,\ width*10,\ height*40,\ TRUE);}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00060}00060\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00061}00061\ \ \ \ \ \textcolor{keywordflow}{case}\ 0:}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00062}00062\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ buffer[256];}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00063}00063\ \ \ \ \ \ \ \ \ sprintf\_s(buffer,\textcolor{stringliteral}{"{}mode\ con\ cols=\%d\ lines=\%d"{}},width,height);}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00064}00064\ \ \ \ \ \ \ \ \ system(buffer);}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00065}00065\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00066}00066\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00067}00067\ \}}
\DoxyCodeLine{\Hypertarget{manage_console_8cpp_source_l00068}00068\ }

\end{DoxyCode}
